---
import Layout from '~/layouts/Media/FilmShowLayout.astro'


export async function getStaticPaths() {
	const scope = import.meta.env.COUNTRY_SCOPE
	const filmsResponse = await fetch(`https://api.arclight.org/v2/media-countries/${scope}?apiKey=52b06248a3c6e8.12980089&expand=mediaLanguages&metadataLanguageTags=en`);
	const data = await filmsResponse.json();
	let films = data['_embedded']['mediaLanguages'];

  	if(scope !== 'all') {
  	  films = films.filter(item => {return item.primaryCountryId == scope})
  	}

  return films.map((film) => { return { params: { id: film.iso3 + '-' + film.languageId } } });
}
---
<Layout />