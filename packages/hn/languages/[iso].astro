---
import Layout from "~/layouts/PageLayout.astro";
import { SITE,getLanguageFromPath } from "~/config.mjs";
import LanguageShow from "~/components/partials/LanguageShow.svelte";
export async function getStaticPaths() {
  let data = await fetch(`${SITE.apiUrl}/languages.json`).then((response) =>
    response.json()
  );

  let languages = []
  data.forEach(language => {
    if(language.ci === import.meta.env.COUNTRY_ID) {
		languages.push(language)
    }
  });

  return languages.map((language) => {
    return {
      params: { iso: language.id },
    };
  });
}

const { iso } = Astro.params;
const languageResponse = await fetch(`${SITE.apiUrl}/languages/${iso}.json`);
const language = await languageResponse.json();
const locale = getLanguageFromPath(Astro.url);
---

<Layout>

  <LanguageShow language={language} locale={locale} client:only />

</Layout>
